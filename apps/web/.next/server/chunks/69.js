exports.id=69,exports.ids=[69],exports.modules={3069:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AutomatedPhotoCapture:()=>k});var r=s(5402),i=s(6964),n=s(9472),a=s(1931),o=s(76),l=s(3432),c=s(6360),d=s(4465),u=s(6881),h=s(1733),p=s(822),g=s(7850);let m=(0,g.Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var f=s(7737),y=s(3086);class x{constructor(){this.currentSession=null,this.isCapturing=!1,this.voiceQueue=[],this.captureSteps=[],this.initializeCaptureSteps()}initializeCaptureSteps(){this.captureSteps=[{type:"front",name:"Front View",description:"Stand facing the camera with good posture",instructions:["Stand 6-8 feet from the camera","Face the camera directly","Keep your arms slightly away from your body","Stand with feet shoulder-width apart","Look straight ahead","Maintain natural posture"],positioningGuide:{distance:7,height:80,width:60,posture:["Stand straight with shoulders back","Keep your head level","Arms slightly away from body","Feet shoulder-width apart"],clothing:["Wear form-fitting but comfortable clothing","Avoid baggy clothes that hide body shape","Consider wearing the same outfit for consistency"],lighting:["Ensure even lighting from the front","Avoid harsh shadows","Natural light is preferred"],background:["Use a plain, neutral background","Avoid cluttered or busy backgrounds","Ensure good contrast with your clothing"]},isCompleted:!1},{type:"side",name:"Side View",description:"Turn 90 degrees to show your profile",instructions:["Turn 90 degrees to your right","Keep your head facing forward","Maintain the same posture as front view","Arms slightly away from body","Stand naturally"],positioningGuide:{distance:7,height:80,width:60,posture:["Turn 90 degrees to the right","Keep head facing forward","Maintain straight posture","Arms slightly away from body"],clothing:["Same clothing as front view","Ensure clothing shows body shape clearly"],lighting:["Ensure even lighting from the side","Avoid harsh shadows on face and body"],background:["Same background as front view","Ensure good contrast"]},isCompleted:!1},{type:"back",name:"Back View",description:"Turn to show your back view",instructions:["Turn 180 degrees from front view","Face away from the camera","Keep your head level","Maintain good posture","Arms slightly away from body"],positioningGuide:{distance:7,height:80,width:60,posture:["Turn 180 degrees from front position","Face away from camera","Keep head level and straight","Maintain straight posture","Arms slightly away from body"],clothing:["Same clothing as previous views","Ensure back is clearly visible"],lighting:["Ensure even lighting on back","Avoid shadows that hide definition"],background:["Same background as previous views","Good contrast with clothing"]},isCompleted:!1},{type:"full_body",name:"Full Body View",description:"Step back to show your full body",instructions:["Step back 2-3 feet further","Ensure your entire body is visible","Maintain the same posture","Keep your head level","Arms slightly away from body"],positioningGuide:{distance:10,height:90,width:70,posture:["Stand 10 feet from camera","Ensure full body is in frame","Maintain straight posture","Head level, arms slightly away"],clothing:["Same clothing as all previous views","Ensure full body is clearly visible"],lighting:["Ensure even lighting on entire body","Avoid shadows that hide body shape"],background:["Same background as previous views","Ensure full body stands out clearly"]},isCompleted:!1}]}startCaptureSession(e){let t={id:this.generateId(),userId:e,date:new Date().toISOString().split("T")[0],status:"preparing",currentStep:this.captureSteps[0],photos:[],instructions:[],startTime:new Date().toISOString()};return this.currentSession=t,this.isCapturing=!0,this.addVoiceInstruction({id:this.generateId(),text:"Welcome to your progress photo session! I'll guide you through each position to ensure consistent, high-quality photos.",priority:"high",timing:"immediate"}),this.addVoiceInstruction({id:this.generateId(),text:"Let's start with the front view. Please stand 6-8 feet from the camera and face me directly.",priority:"high",timing:"immediate"}),t}getCurrentSession(){return this.currentSession}addVoiceInstruction(e){this.voiceQueue.push(e),this.speakInstruction(e)}speakInstruction(e){if("speechSynthesis"in window){let t=new SpeechSynthesisUtterance(e.text);t.rate=.9,t.pitch=1,t.volume=1;let s=speechSynthesis.getVoices(),r=s.find(e=>e.lang.includes("en")&&e.name.includes("Google"))||s.find(e=>e.lang.includes("en"));r&&(t.voice=r),speechSynthesis.speak(t)}}analyzePositioning(e){let t={isInPosition:Math.random()>.3,quality:Math.floor(40*Math.random())+60,recommendations:["Move slightly to the left","Stand a bit closer to the camera","Straighten your posture"].slice(0,Math.floor(3*Math.random())+1)};return t}async capturePhoto(e){if(!this.currentSession||!this.isCapturing)return null;try{let t=document.createElement("canvas"),s=t.getContext("2d");if(!s)throw Error("Could not get canvas context");t.width=e.videoWidth,t.height=e.videoHeight,s.drawImage(e,0,0,t.width,t.height);let r=await new Promise(e=>{t.toBlob(t=>{t&&e(t)},"image/jpeg",.9)}),i=URL.createObjectURL(r),n=await this.createThumbnail(r),a=this.analyzeCapturedPhoto(r),o={id:this.generateId(),type:this.currentSession.currentStep.type,imageUrl:i,thumbnailUrl:n,metadata:{timestamp:new Date().toISOString(),quality:a.quality,lighting:Math.floor(30*Math.random())+70,positioning:Math.floor(30*Math.random())+70,blur:Math.floor(20*Math.random())+10},analysis:{bodyDetected:a.bodyDetected,faceDetected:a.faceDetected,poseQuality:a.poseQuality,recommendations:a.recommendations}};return this.currentSession.photos.push(o),this.currentSession.currentStep.photoId=o.id,this.currentSession.currentStep.isCompleted=!0,this.addVoiceInstruction({id:this.generateId(),text:`Great! ${this.currentSession.currentStep.name} captured successfully.`,priority:"medium",timing:"after_capture"}),o}catch(e){return console.error("Error capturing photo:",e),this.addVoiceInstruction({id:this.generateId(),text:"There was an issue capturing the photo. Let's try again.",priority:"high",timing:"immediate",action:"retake"}),null}}async createThumbnail(e){return new Promise(t=>{let s=document.createElement("canvas"),r=s.getContext("2d"),i=new Image;i.onload=()=>{if(!r){t(URL.createObjectURL(e));return}let n=Math.min(200/i.width,200/i.height);s.width=i.width*n,s.height=i.height*n,r.drawImage(i,0,0,s.width,s.height),s.toBlob(s=>{s?t(URL.createObjectURL(s)):t(URL.createObjectURL(e))},"image/jpeg",.8)},i.src=URL.createObjectURL(e)})}analyzeCapturedPhoto(e){return{bodyDetected:Math.random()>.1,faceDetected:Math.random()>.2,poseQuality:Math.floor(40*Math.random())+60,quality:Math.floor(30*Math.random())+70,recommendations:["Good positioning!","Lighting looks great","Posture is excellent"].slice(0,Math.floor(3*Math.random())+1)}}nextStep(){if(!this.currentSession)return null;let e=this.captureSteps.findIndex(e=>e.type===this.currentSession.currentStep.type);if(!(e<this.captureSteps.length-1))return this.completeSession(),null;{let t=this.captureSteps[e+1];return this.currentSession.currentStep=t,this.addVoiceInstruction({id:this.generateId(),text:`Now let's capture the ${t.name.toLowerCase()}. ${t.instructions[0]}`,priority:"high",timing:"immediate"}),t}}completeSession(){this.currentSession&&(this.currentSession.status="completed",this.currentSession.endTime=new Date().toISOString(),this.isCapturing=!1,this.addVoiceInstruction({id:this.generateId(),text:"Excellent! All progress photos have been captured successfully. Your photos are now saved to your profile.",priority:"high",timing:"immediate"}),this.savePhotosToProfile())}savePhotosToProfile(){this.currentSession&&Promise.resolve().then(s.bind(s,3846)).then(({userProfileService:e})=>{this.currentSession.photos.forEach(t=>{let s={userId:this.currentSession.userId,date:this.currentSession.date,type:t.type,imageUrl:t.imageUrl,thumbnailUrl:t.thumbnailUrl,weight:void 0,bodyFat:void 0,muscleMass:void 0,notes:`Automated capture - ${t.type} view`,isPrivate:!0,tags:[t.type,"automated","progress"]};e.addProgressPhoto(s)})})}retakeCurrentStep(){if(!this.currentSession)return;this.currentSession.currentStep.isCompleted=!1,this.currentSession.currentStep.photoId=void 0;let e=this.currentSession.photos[this.currentSession.photos.length-1];e&&e.type===this.currentSession.currentStep.type&&this.currentSession.photos.pop(),this.addVoiceInstruction({id:this.generateId(),text:`Let's retake the ${this.currentSession.currentStep.name.toLowerCase()}. ${this.currentSession.currentStep.instructions[0]}`,priority:"high",timing:"immediate"})}getPositioningFeedback(e){let t=this.analyzePositioning(e);return t.isInPosition?{isInPosition:!0,feedback:["Perfect position!","Ready to capture"],nextInstruction:"Hold still, capturing in 3... 2... 1..."}:{isInPosition:!1,feedback:t.recommendations,nextInstruction:"Please adjust your position and try again"}}stopSession(){this.currentSession&&(this.currentSession.status="failed",this.currentSession.endTime=new Date().toISOString()),this.isCapturing=!1,this.currentSession=null,"speechSynthesis"in window&&speechSynthesis.cancel()}getSessionProgress(){if(!this.currentSession)return{currentStep:0,totalSteps:this.captureSteps.length,percentage:0,remainingSteps:this.captureSteps.map(e=>e.name)};let e=this.captureSteps.findIndex(e=>e.type===this.currentSession.currentStep.type),t=this.captureSteps.filter(e=>e.isCompleted).length,s=t/this.captureSteps.length*100,r=this.captureSteps.slice(e+1).map(e=>e.name);return{currentStep:e+1,totalSteps:this.captureSteps.length,percentage:Math.round(s),remainingSteps:r}}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}}let v=new x;var S=s(3846),w=s(7137),b=s.n(w);let j=({videoElement:e,photoType:t,onPositionUpdate:s,className:n="",videoDimensions:a})=>{let[o,l]=(0,i.useState)(!0),[c,d]=(0,i.useState)(!1),u=(0,i.useRef)(null),h=(0,i.useRef)(null);return((0,i.useEffect)(()=>{e&&e.readyState>=2&&setTimeout(()=>{d(!0),s?.(!0,["Perfect position!"])},2e3)},[e,s]),(0,i.useEffect)(()=>{if(o&&u.current&&e){let e=u.current,t=e.getContext("2d");if(t){let s=h.current;s&&(e.width=s.clientWidth,e.height=s.clientHeight),t.clearRect(0,0,e.width,e.height),t.strokeStyle="#00ff00",t.lineWidth=3,t.beginPath();let r=e.width/2,i=e.height/2,n=.3*Math.min(e.width,e.height);t.arc(r,i-.8*n,.15*n,0,2*Math.PI),t.moveTo(r,i-.6*n),t.lineTo(r,i+.4*n),t.moveTo(r-.3*n,i-.2*n),t.lineTo(r+.3*n,i-.2*n),t.moveTo(r,i+.4*n),t.lineTo(r-.2*n,i+.8*n),t.moveTo(r,i+.4*n),t.lineTo(r+.2*n,i+.8*n),t.stroke()}}},[o,e]),e)?(0,r.jsxs)("div",{ref:h,style:{zIndex:99999,position:"absolute",top:0,left:0,width:"100%",height:"100%"},className:`jsx-e0ba8980a1a0dd1d absolute inset-0 pointer-events-none ${n}`,children:[o&&r.jsx("canvas",{ref:u,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:99998,pointerEvents:"none"},className:"jsx-e0ba8980a1a0dd1d"}),r.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:99999,fontSize:"6rem",fontWeight:"bold",color:"white",textShadow:"0 0 20px white, 0 0 40px white, 0 0 60px white, 0 0 80px white",filter:"drop-shadow(0 0 10px white) drop-shadow(0 0 20px white)",animation:"pulse 2s infinite"},className:"jsx-e0ba8980a1a0dd1d",children:"✕"}),r.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"80px",height:"80px",border:"3px solid #00ff00",backgroundColor:"rgba(0, 255, 0, 0.1)",borderRadius:"50%",zIndex:99997,animation:c?"pulse 1s infinite":"none"},className:"jsx-e0ba8980a1a0dd1d"}),r.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"60%",height:"85%",border:"2px dashed #00ff00",backgroundColor:"rgba(0, 255, 0, 0.05)",borderRadius:"8px",zIndex:99996},className:"jsx-e0ba8980a1a0dd1d"}),(0,r.jsxs)("div",{style:{position:"absolute",top:"10px",left:"10px",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"8px 12px",borderRadius:"4px",fontSize:"12px",zIndex:99999,display:"flex",alignItems:"center",gap:"8px"},className:"jsx-e0ba8980a1a0dd1d",children:[r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:c?"#00ff00":"#ffaa00",animation:c?"pulse 1s infinite":"none"},className:"jsx-e0ba8980a1a0dd1d"}),c?"Position: Optimal":"Position: Adjusting..."]}),(0,r.jsxs)("button",{onClick:()=>l(!o),style:{position:"absolute",top:"10px",right:"10px",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"8px 12px",borderRadius:"4px",fontSize:"12px",zIndex:99999,border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},className:"jsx-e0ba8980a1a0dd1d",children:[r.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:o?"#00ff00":"#666"},className:"jsx-e0ba8980a1a0dd1d"}),"Skeleton: ",o?"ON":"OFF"]}),r.jsx("div",{style:{position:"absolute",bottom:"60px",left:"50%",transform:"translateX(-50%)",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",padding:"8px 16px",borderRadius:"20px",fontSize:"14px",zIndex:99999,textAlign:"center",maxWidth:"80%"},className:"jsx-e0ba8980a1a0dd1d",children:'Stand on the X mark • 6-8 feet from camera • Say "ready" when positioned'}),r.jsx(b(),{id:"e0ba8980a1a0dd1d",children:"@-webkit-keyframes pulse{0%{opacity:1}50%{opacity:.7}100%{opacity:1}}@-moz-keyframes pulse{0%{opacity:1}50%{opacity:.7}100%{opacity:1}}@-o-keyframes pulse{0%{opacity:1}50%{opacity:.7}100%{opacity:1}}@keyframes pulse{0%{opacity:1}50%{opacity:.7}100%{opacity:1}}"})]}):null},k=({className:e="",onComplete:t,onCancel:s})=>{let[g,x]=(0,i.useState)(null),[w,b]=(0,i.useState)(!1),[k,N]=(0,i.useState)(!1),[P,I]=(0,i.useState)(!0),[C,R]=(0,i.useState)(!1),[M,T]=(0,i.useState)(!1),[F,U]=(0,i.useState)([]),[D,E]=(0,i.useState)([]),[z,_]=(0,i.useState)(!1),[A,V]=(0,i.useState)(null),[O,L]=(0,i.useState)(null),[Z,W]=(0,i.useState)(null),[$,B]=(0,i.useState)({width:0,height:0}),G=(0,i.useRef)(null),q=(0,i.useRef)(null),H=(0,i.useRef)(null),Y=(0,i.useRef)(null),K=(0,i.useRef)(null),Q=(0,i.useRef)(null);(0,i.useEffect)(()=>()=>{q.current&&q.current.getTracks().forEach(e=>e.stop()),H.current&&clearInterval(H.current),Y.current&&clearInterval(Y.current),Q.current&&clearInterval(Q.current),K.current&&K.current.stop(),v.stopSession()},[]),(0,i.useEffect)(()=>{console.log("Camera effect triggered:",{session:!!g,isCameraActive:w}),g&&!w&&(console.log("Session started, initializing camera..."),es())},[g,w]),(0,i.useEffect)(()=>{g&&P&&(console.log("Starting voice instructions..."),X())},[g,P]);let X=()=>{Y.current&&clearInterval(Y.current),v.addVoiceInstruction({id:"initial",text:'Welcome to your progress photo session. You should see a HUGE WHITE X MARK in the center of your screen. Stand directly on top of this X mark, about 6 to 8 feet from the camera. Say "ready" when you\'re positioned on the X.',priority:"high",timing:"immediate"});let e={id:"step",text:`For the ${g?.currentStep.name}, ${g?.currentStep.description}. ${g?.currentStep.instructions.join(". ")}. Look for the HUGE WHITE X MARK in the center of your screen and stand directly on top of it. When you're ready, say "ready" or "okay".`,priority:"high",timing:"immediate"};v.addVoiceInstruction(e),J(),Y.current=setInterval(()=>{g&&P&&!C&&v.addVoiceInstruction({id:"encouragement",text:"You're doing great! Look for the green target area with the X mark in the center of your screen. Stand in the center of that area and say \"ready\" when you're positioned correctly.",priority:"medium",timing:"immediate"})},15e3)},J=()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){console.log("Speech recognition not supported");return}let e=window.SpeechRecognition||window.webkitSpeechRecognition;K.current=new e,K.current.continuous=!0,K.current.interimResults=!1,K.current.lang="en-US",K.current.onstart=()=>{console.log("Voice recognition started"),R(!0)},K.current.onresult=e=>{let t=e.results[e.results.length-1][0].transcript.toLowerCase();console.log("Heard:",t),t.includes("ready")||t.includes("okay")||t.includes("ok")?ee():t.includes("capture")||t.includes("take photo")?ei():(t.includes("stop")||t.includes("cancel"))&&en()},K.current.onerror=e=>{console.error("Speech recognition error:",e.error),R(!1)},K.current.onend=()=>{console.log("Voice recognition ended"),R(!1),setTimeout(()=>{g&&P&&J()},1e3)};try{K.current.start()}catch(e){console.error("Error starting voice recognition:",e)}},ee=()=>{if(M)et();else if("speechSynthesis"in window){let e=new SpeechSynthesisUtterance(F.length>0?F[0]:"I can see you're not quite in the right position yet. Please adjust your position and try again.");speechSynthesis.speak(e)}},et=()=>{if(L(3),"speechSynthesis"in window){let e=new SpeechSynthesisUtterance("Perfect! Starting countdown in 3, 2, 1...");speechSynthesis.speak(e)}Q.current=setInterval(()=>{L(e=>null===e||e<=1?(clearInterval(Q.current),ei(),null):e-1)},1e3)},es=async()=>{try{if(console.log("Starting camera..."),W(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw Error("getUserMedia is not supported in this browser");let e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720},facingMode:"user"}});console.log("Camera stream obtained:",e),console.log("Video tracks:",e.getVideoTracks());let t=0;for(;!G.current&&t<20;)console.log(`Waiting for video ref... attempt ${t+1}`),await new Promise(e=>setTimeout(e,100)),t++;if(G.current){console.log("Video ref found, setting stream..."),G.current.srcObject=e,q.current=e,G.current.onloadedmetadata=()=>{if(console.log("Video metadata loaded"),G.current){let e=G.current.videoWidth,t=G.current.videoHeight;console.log("Video dimensions:",e,"x",t),B({width:e,height:t})}},G.current.oncanplay=()=>{console.log("Video can play")},G.current.onplay=()=>{console.log("Video started playing"),b(!0)},G.current.onerror=e=>{console.error("Video error:",e),W("Video playback error occurred")};let t=0;for(;t<3;)try{await G.current.play(),console.log("Video play() successful");break}catch(e){if(console.error(`Error playing video (attempt ${t+1}):`,e),++t>=3)throw Error("Failed to start video playback after multiple attempts");await new Promise(e=>setTimeout(e,500))}}else throw console.error("Video ref is still null after waiting"),Error("Video element not available")}catch(e){console.error("Error accessing camera:",e),W(`Unable to access camera: ${e.message}. Please check permissions.`),alert(`Camera Error: ${e.message}. Please check camera permissions and try again.`)}},er=async()=>{console.log("Start session button clicked");let e=S.userProfileService.getCurrentProfile();if(!e){console.log("No user profile found, creating sample profile");let e={id:"test-user-1",firstName:"Test",lastName:"User",displayName:"Test User",email:"test@example.com",height:{feet:5,inches:9,centimeters:175},weight:{pounds:154,kilograms:70},fitnessLevel:"beginner",fitnessGoals:["weight loss","strength"],activityLevel:"moderately_active",timezone:"America/New_York",language:"en",units:"imperial",privacySettings:{profileVisibility:"private",progressPhotos:"private",weightData:"private",workoutHistory:"private",achievements:"private"},preferences:{workoutDuration:30,workoutFrequency:3,preferredWorkoutTime:"evening",voiceCoachStyle:"motivational",notifications:{workoutReminders:!0,progressUpdates:!0,achievements:!0,weeklyReports:!0}},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};S.userProfileService.updateProfile(e)}console.log("Starting capture session...");let t=v.startCaptureSession(e?.id||"test-user-1");console.log("Session created:",t),x(t)},ei=async()=>{if(G.current&&g){N(!0);try{let e=await v.capturePhoto(G.current);e&&(E(t=>[...t,e]),V(e),_(!0))}catch(e){console.error("Error capturing photo:",e)}finally{N(!1)}}},en=()=>{v.stopSession(),q.current&&q.current.getTracks().forEach(e=>e.stop()),H.current&&clearInterval(H.current),Y.current&&clearInterval(Y.current),Q.current&&clearInterval(Q.current),K.current&&K.current.stop(),L(null),R(!1),b(!1),W(null),s&&s()},ea=v.getSessionProgress();return g?(0,r.jsxs)("div",{className:`space-y-6 ${e}`,children:[(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)(n.ll,{className:"flex items-center gap-2",children:[r.jsx(a.Z,{className:"h-5 w-5 text-blue-500"}),"Progress Photo Session"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(n.zx,{variant:"outline",size:"sm",onClick:()=>{let e=!P;I(e),"speechSynthesis"in window&&P&&speechSynthesis.cancel(),e&&g?X():Y.current&&clearInterval(Y.current)},className:"flex items-center gap-2",children:[P?r.jsx(o.Z,{className:"h-4 w-4"}):r.jsx(l.Z,{className:"h-4 w-4"}),P?"Voice On":"Voice Off"]}),(0,r.jsxs)(n.zx,{variant:"outline",size:"sm",onClick:en,className:"flex items-center gap-2 text-red-600",children:[r.jsx(c.Z,{className:"h-4 w-4"}),"Stop Session"]})]})]})}),r.jsx(n.aY,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,r.jsxs)("span",{children:["Step ",ea.currentStep," of ",ea.totalSteps]}),(0,r.jsxs)("span",{children:[ea.percentage,"% Complete"]})]}),r.jsx(n.Ex,{value:ea.percentage,className:"h-2"})]}),(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[r.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:g.currentStep.name}),r.jsx("p",{className:"text-blue-700 text-sm mb-3",children:g.currentStep.description}),r.jsx("div",{className:"space-y-1",children:g.currentStep.instructions.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[r.jsx(d.Z,{className:"h-3 w-3"}),e]},t))})]}),ea.remainingSteps.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Remaining Steps:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:ea.remainingSteps.map((e,t)=>r.jsx(n.Ct,{variant:"outline",className:"text-xs",children:e},t))})]})]})})]}),(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center gap-2",children:[r.jsx(u.Z,{className:"h-5 w-5 text-green-500"}),"Camera Feed"]})}),r.jsx(n.aY,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"relative bg-black rounded-lg overflow-hidden",children:[r.jsx("video",{ref:G,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-96 object-cover",style:{minHeight:"384px"}}),(0,r.jsxs)("div",{className:"absolute top-2 left-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs z-10",children:["Camera: ",w?"Active":"Inactive"]}),(0,r.jsxs)("div",{className:"absolute top-2 right-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs z-10",children:["Voice: ",C?"\uD83C\uDFA4 Listening":"\uD83D\uDD07 Idle"]}),null!==O&&r.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20",children:r.jsx("div",{className:"bg-black bg-opacity-80 text-white text-8xl font-bold rounded-full w-32 h-32 flex items-center justify-center",children:O})}),r.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center gap-2 z-10",children:(0,r.jsxs)(n.zx,{onClick:ei,disabled:k||!M,className:"flex items-center gap-2",children:[r.jsx(a.Z,{className:"h-4 w-4"}),k?"Capturing...":"Capture Photo"]})}),g&&w&&G.current&&r.jsx(j,{videoElement:G.current,photoType:g.currentStep.type,onPositionUpdate:(e,t)=>{T(e),U(t)},videoDimensions:$})]}),Z&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-sm text-red-800",children:[r.jsx("strong",{children:"Camera Error:"})," ",Z]}),r.jsx(n.zx,{onClick:es,variant:"outline",size:"sm",className:"mt-2",children:"Retry Camera"})]}),w&&(0,r.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"Position Status:"})," ",M?"Optimal":"Needs Adjustment"]}),F.length>0&&r.jsx("div",{className:"mt-2 text-xs text-blue-600",children:F[0]})]})]})})]}),D.length>0&&(0,r.jsxs)(n.Zb,{children:[r.jsx(n.Ol,{children:(0,r.jsxs)(n.ll,{className:"flex items-center gap-2",children:[r.jsx(h.Z,{className:"h-5 w-5 text-green-500"}),"Captured Photos (",D.length,"/",ea.totalSteps,")"]})}),(0,r.jsxs)(n.aY,{children:[r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:D.map(e=>(0,r.jsxs)(f.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"relative group cursor-pointer",onClick:()=>{V(e),_(!0)},children:[(0,r.jsxs)("div",{className:"aspect-[3/4] rounded-lg overflow-hidden bg-gray-100",children:[r.jsx("img",{src:e.thumbnailUrl,alt:`${e.type} view`,className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center",children:r.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:r.jsx(h.Z,{className:"h-6 w-6 text-white"})})})]}),(0,r.jsxs)("div",{className:"mt-2 text-center",children:[r.jsx("div",{className:"text-sm font-medium capitalize",children:e.type}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["Quality: ",e.metadata.quality,"%"]})]})]},e.id))}),(0,r.jsxs)("div",{className:"flex justify-center gap-4 mt-6",children:[(0,r.jsxs)(n.zx,{variant:"outline",onClick:()=>{v.retakeCurrentStep(),x(v.getCurrentSession()),E(e=>e.slice(0,-1))},className:"flex items-center gap-2",children:[r.jsx(p.Z,{className:"h-4 w-4"}),"Retake Current"]}),(0,r.jsxs)(n.zx,{onClick:()=>{let e=v.nextStep();if(e)x(v.getCurrentSession());else{let e=v.getCurrentSession();e&&t&&t(e.photos)}},disabled:!g.currentStep.isCompleted,className:"flex items-center gap-2",children:[ea.currentStep===ea.totalSteps?"Complete Session":"Next Step",r.jsx(m,{className:"h-4 w-4"})]})]})]})]}),r.jsx(y.M,{children:z&&A&&r.jsx(f.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>_(!1),children:(0,r.jsxs)(f.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold",children:[A.type.charAt(0).toUpperCase()+A.type.slice(1)," View"]}),r.jsx(n.zx,{variant:"ghost",size:"sm",onClick:()=>_(!1),children:r.jsx(c.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("div",{className:"aspect-[3/4] rounded-lg overflow-hidden bg-gray-100",children:r.jsx("img",{src:A.imageUrl,alt:`${A.type} view`,className:"w-full h-full object-cover"})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-700",children:"Quality Metrics:"}),(0,r.jsxs)("div",{className:"space-y-1 text-gray-600",children:[(0,r.jsxs)("div",{children:["Overall Quality: ",A.metadata.quality,"%"]}),(0,r.jsxs)("div",{children:["Lighting: ",A.metadata.lighting,"%"]}),(0,r.jsxs)("div",{children:["Positioning: ",A.metadata.positioning,"%"]}),(0,r.jsxs)("div",{children:["Blur: ",A.metadata.blur,"%"]})]})]}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-700",children:"Analysis:"}),(0,r.jsxs)("div",{className:"space-y-1 text-gray-600",children:[(0,r.jsxs)("div",{children:["Body Detected: ",A.analysis.bodyDetected?"Yes":"No"]}),(0,r.jsxs)("div",{children:["Face Detected: ",A.analysis.faceDetected?"Yes":"No"]}),(0,r.jsxs)("div",{children:["Pose Quality: ",A.analysis.poseQuality,"%"]})]})]})]}),A.analysis.recommendations.length>0&&(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-700 mb-2",children:"Recommendations:"}),r.jsx("ul",{className:"space-y-1",children:A.analysis.recommendations.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-600 flex items-center gap-2",children:[r.jsx(h.Z,{className:"h-3 w-3 text-green-500"}),e]},t))})]})]})]})})})]}):(0,r.jsxs)("div",{className:`text-center p-8 ${e}`,children:[r.jsx(a.Z,{className:"h-16 w-16 text-blue-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Automated Progress Photo Capture"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Get guided through consistent progress photos with AI voice instructions"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(n.zx,{onClick:er,size:"lg",className:"flex items-center gap-2",children:[r.jsx(a.Z,{className:"h-5 w-5"}),"Start Photo Session"]}),(0,r.jsxs)(n.zx,{onClick:es,variant:"outline",size:"lg",className:"flex items-center gap-2",disabled:w,children:[r.jsx(a.Z,{className:"h-5 w-5"}),w?"Camera Active":"Test Camera Only"]})]})]})}},3846:(e,t,s)=>{"use strict";s.r(t),s.d(t,{UserProfileService:()=>r,userProfileService:()=>i});class r{constructor(){this.profiles=[],this.progressPhotos=[],this.currentUser=null,this.loadFromStorage()}createProfile(e){let t={...e,id:this.generateId(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.profiles.push(t),this.currentUser=t,this.saveToStorage(),t}getCurrentProfile(){return this.currentUser}updateProfile(e){if(!this.currentUser)return null;this.currentUser={...this.currentUser,...e,updatedAt:new Date().toISOString()};let t=this.profiles.findIndex(e=>e.id===this.currentUser.id);return -1!==t&&(this.profiles[t]=this.currentUser),this.saveToStorage(),this.currentUser}addProgressPhoto(e){let t={...e,id:this.generateId(),createdAt:new Date().toISOString()};return this.progressPhotos.push(t),this.saveToStorage(),t}getProgressPhotos(e,t=!1){let s=e||this.currentUser?.id;return s?this.progressPhotos.filter(e=>e.userId===s).filter(e=>t||!e.isPrivate).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()):[]}getProgressPhotosByDateRange(e,t,s){let r=this.getProgressPhotos(s,!0);return r.filter(s=>s.date>=e&&s.date<=t)}deleteProgressPhoto(e){let t=this.progressPhotos.findIndex(t=>t.id===e);return -1!==t&&(this.progressPhotos.splice(t,1),this.saveToStorage(),!0)}updateProgressPhoto(e,t){let s=this.progressPhotos.findIndex(t=>t.id===e);return -1===s?null:(this.progressPhotos[s]={...this.progressPhotos[s],...t},this.saveToStorage(),this.progressPhotos[s])}calculateBMI(){if(!this.currentUser)return null;let e=this.currentUser.height.centimeters/100,t=this.currentUser.weight.kilograms;return t/(e*e)}getBMICategory(){let e=this.calculateBMI();return e?e<18.5?"underweight":e<25?"normal":e<30?"overweight":"obese":null}calculateBMR(){if(!this.currentUser)return null;let{weight:e,height:t,gender:s,dateOfBirth:r}=this.currentUser;if(!r)return null;let i=this.calculateAge(r),n=e.kilograms,a=t.centimeters;return"male"===s?10*n+6.25*a-5*i+5:"female"===s?10*n+6.25*a-5*i-161:(10*n+6.25*a-5*i+5+(10*n+6.25*a-5*i-161))/2}calculateTDEE(){let e=this.calculateBMR();if(!e||!this.currentUser)return null;let t={sedentary:1.2,lightly_active:1.375,moderately_active:1.55,very_active:1.725,extremely_active:1.9}[this.currentUser.activityLevel];return e*t}calculateAge(e){let t=new Date,s=new Date(e),r=t.getFullYear()-s.getFullYear(),i=t.getMonth()-s.getMonth();return(i<0||0===i&&t.getDate()<s.getDate())&&r--,r}static feetInchesToCm(e,t){return(12*e+t)*2.54}static cmToFeetInches(e){let t=e/2.54;return{feet:Math.floor(t/12),inches:Math.round(t%12)}}static poundsToKg(e){return .453592*e}static kgToPounds(e){return 2.20462*e}getUserStats(){return{totalWorkouts:45,totalWorkoutTime:2700,currentStreak:7,longestStreak:21,totalWeightLost:15.5,totalWeightGained:0,averageWorkoutDuration:36,favoriteExercises:["Push-ups","Squats","Planks","Lunges"],achievements:["First Workout","7-Day Streak","Weight Loss Goal"],level:5,experiencePoints:1250}}canViewProfile(e){let t=this.profiles.find(t=>t.id===e);return!!t&&(e===this.currentUser?.id||"public"===t.privacySettings.profileVisibility)}canViewProgressPhotos(e){let t=this.profiles.find(t=>t.id===e);return!!t&&(e===this.currentUser?.id||"public"===t.privacySettings.progressPhotos)}generateId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}saveToStorage(){}loadFromStorage(){}clearAllData(){this.profiles=[],this.progressPhotos=[],this.currentUser=null,this.saveToStorage()}addSampleData(){this.createProfile({email:"john.doe@example.com",firstName:"John",lastName:"Doe",displayName:"JohnDoe",dateOfBirth:"1990-05-15",gender:"male",height:{feet:5,inches:10,centimeters:178},weight:{pounds:180,kilograms:81.6},fitnessLevel:"intermediate",fitnessGoals:["Lose Weight","Build Muscle","Improve Endurance"],activityLevel:"moderately_active",timezone:"America/New_York",language:"en",units:"imperial",privacySettings:{profileVisibility:"public",progressPhotos:"private",weightData:"private",workoutHistory:"friends",achievements:"public"},preferences:{workoutDuration:45,workoutFrequency:4,preferredWorkoutTime:"evening",musicPreference:"Motivational",voiceCoachStyle:"motivational",notifications:{workoutReminders:!0,progressUpdates:!0,achievements:!0,weeklyReports:!0}}});let e=new Date,t=[];for(let s=29;s>=0;s-=7){let r=new Date(e);r.setDate(r.getDate()-s);let i=180-(29-s)*.5;t.push({userId:this.currentUser.id,date:r.toISOString().split("T")[0],type:"front",imageUrl:`https://via.placeholder.com/400x600/4F46E5/FFFFFF?text=Progress+Photo+${r.toLocaleDateString()}`,thumbnailUrl:"https://via.placeholder.com/200x300/4F46E5/FFFFFF?text=Thumbnail",weight:Math.round(10*i)/10,bodyFat:Math.round((25-(29-s)*.2)*10)/10,muscleMass:Math.round((150-(29-s)*.1)*10)/10,notes:`Week ${Math.floor((29-s)/7)+1} progress photo`,isPrivate:!0,tags:["front","weekly","progress"]}),t.push({userId:this.currentUser.id,date:r.toISOString().split("T")[0],type:"side",imageUrl:`https://via.placeholder.com/400x600/10B981/FFFFFF?text=Side+View+${r.toLocaleDateString()}`,thumbnailUrl:"https://via.placeholder.com/200x300/10B981/FFFFFF?text=Side",weight:Math.round(10*i)/10,bodyFat:Math.round((25-(29-s)*.2)*10)/10,muscleMass:Math.round((150-(29-s)*.1)*10)/10,notes:`Week ${Math.floor((29-s)/7)+1} side view`,isPrivate:!0,tags:["side","weekly","progress"]})}t.forEach(e=>this.addProgressPhoto(e))}}let i=new r},1733:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(7850);let i=(0,r.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},822:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(7850);let i=(0,r.Z)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},76:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(7850);let i=(0,r.Z)("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]])},3432:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var r=s(7850);let i=(0,r.Z)("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]])},1620:()=>{},1669:(e,t,s)=>{s(1620);var r=s(6964),i=function(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}(r);function n(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a="undefined"!=typeof process&&process.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},StyleSheet=function(){function StyleSheet(e){var t=void 0===e?{}:e,s=t.name,r=void 0===s?"stylesheet":s,i=t.optimizeForSpeed,n=void 0===i?a:i;l(o(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",l("boolean"==typeof n,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=n,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0,this._nonce=null}var e,t=StyleSheet.prototype;return t.setOptimizeForSpeed=function(e){l("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),l(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},t.isOptimizeForSpeed=function(){return this._optimizeForSpeed},t.inject=function(){var e=this;l(!this._injected,"sheet already injected"),this._injected=!0,this._serverSheet={cssRules:[],insertRule:function(t,s){return"number"==typeof s?e._serverSheet.cssRules[s]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),s},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},t.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},t.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},t.insertRule=function(e,t){return l(o(e),"`insertRule` accepts only strings"),"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++},t.replaceRule=function(e,t){this._optimizeForSpeed;var s=this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!s.cssRules[e])return e;s.deleteRule(e);try{s.insertRule(t,e)}catch(r){a||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),s.insertRule(this._deletedRulePlaceholder,e)}return e},t.deleteRule=function(e){this._serverSheet.deleteRule(e)},t.flush=function(){this._injected=!1,this._rulesCount=0,this._serverSheet.cssRules=[]},t.cssRules=function(){return this._serverSheet.cssRules},t.makeStyleTag=function(e,t,s){t&&l(o(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var i=document.head||document.getElementsByTagName("head")[0];return s?i.insertBefore(r,s):i.appendChild(r),r},n(StyleSheet.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e&&n(StyleSheet,e),StyleSheet}();function l(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var c=function(e){for(var t=5381,s=e.length;s;)t=33*t^e.charCodeAt(--s);return t>>>0},d={};function u(e,t){if(!t)return"jsx-"+e;var s=String(t),r=e+s;return d[r]||(d[r]="jsx-"+c(e+"-"+s)),d[r]}function h(e,t){var s=e+(t=t.replace(/\/style/gi,"\\/style"));return d[s]||(d[s]=t.replace(/__jsx-style-dynamic-selector/g,e)),d[s]}var p=r.createContext(null);p.displayName="StyleSheetContext",i.default.useInsertionEffect||i.default.useLayoutEffect;var g=void 0;function m(e){var t=g||r.useContext(p);return t&&t.add(e),null}m.dynamic=function(e){return e.map(function(e){return u(e[0],e[1])}).join(" ")},t.style=m},7137:(e,t,s)=>{"use strict";e.exports=s(1669).style}};